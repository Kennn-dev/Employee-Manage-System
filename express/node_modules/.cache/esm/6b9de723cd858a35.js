let verify,sign,SECRETKEY,REFRESHKEY;_cd8‍.x([["getUser",()=>getUser],["getTokens",()=>getTokens]]);_cd8‍.w("jsonwebtoken",[["verify",["verify"],function(v){verify=v}],["sign",["sign"],function(v){sign=v}]]);_cd8‍.w("../config/index",[["SECRETKEY",["SECRETKEY"],function(v){SECRETKEY=v}],["REFRESHKEY",["REFRESHKEY"],function(v){REFRESHKEY=v}]]);



       const getUser = ({ token }) => {
  const user = verify(token, SECRETKEY);
  if (!user) throw new Error("u must be login first");
  return user;
};

       const getTokens = ({ id, username, position }) => {
  const accessToken = sign(
    {
      id,
      position,
      username,
    },
    SECRETKEY,
    { expiresIn: "1d" }
  );

  const refreshToken = sign(
    {
      id,
      position,
      username,
    },
    REFRESHKEY,
    { expiresIn: "10s" }
  );

  return { accessToken, refreshToken };
};
